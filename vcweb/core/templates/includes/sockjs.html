<script type="text/javascript" src="https://d1fxtkz8shb9d2.cloudfront.net/sockjs-0.3.js"></script>
<!--<script type="text/javascript" src="http://cdn.sockjs.org/sockjs-0.3.min.js"></script>-->
<!--<script type="text/javascript" src="{{STATIC_URL}}js/sockjs-0.3.min.js"></script>-->
<script type="text/javascript">
var cachedSocket;
var defaultPort = 8882;
function connect(uri) {
    var port = {{WEBSOCKET_PORT}};
    if ( !port ) {
        console.log("using default port: " + defaultPort);
        port = defaultPort;
    }
    var host = window.location.hostname;
    if ( !host ) {
        console.log("Tried to connect to null host, defaulting to vcweb.asu.edu instead.");
        host = "vcweb.asu.edu";
    }
    var sockjsServer = host + ":" + port + "/" + uri;
    console.log("Establishing connection to " + host + ":" + port + "/" + uri);
    cachedSocket = new SockJS(host);
    cachedSocket.onopen = function() {
        console.log('default vcweb sockjs open');
        cachedSocket.send(createConnectionEvent());
    };
    cachedSocket.onmessage = function(e) {
        console.log('received message', e.data);
    };
    cachedSocket.onclose = function() {
        console.log('default vcweb sockjs closed');
    };
    console.log("connecting to " + host + ":" + port + "/" + uri);
    /*
    cachedSocket.on('disconnect', function(data) {
        console.log("received disconnect, reconnecting.");
        cachedSocket.connect();
        cachedSocket.send(createReconnectionEvent());
    });
    */
    return cachedSocket;
}
function getCachedSocket() {
    return cachedSocket;
}
</script>
