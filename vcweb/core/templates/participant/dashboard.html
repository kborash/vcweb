{% extends "base.html" %}
{% block title %}
Participant Dashboard
{% endblock %}

{% block page %}
{{ block.super }}
<div id='experiments'>
    <div class='alert alert-info'>
        Welcome back, {{request.user.participant}}.
    </div>
    <div data-bind='if: pendingExperiments'>
        <h3>Upcoming experiments</h3>
        <div data-bind="template: { name: 'experimentTemplate', foreach: pendingExperiments }"></div>
    </div>
    <div data-bind='if: runningExperiments'>
        <h3>Running experiments</h3>
        <div data-bind="template: { name: 'experimentTemplate', foreach: runningExperiments }"></div>
    </div>
</div>
{% endblock page %}

{%  block javascript %}
<script type='text/html' id='experimentTemplate'>
<div class='alert alert-message alert-block'>
    <a data-bind='attr: { href: participant_url }'><i class='icon-play'></i><span data-bind='text: status_line'></span>
    <span class='pull-right' data-bind='text: start_date'></span></a>
</div>
</script>
    {{ block.super }}
    <script type='text/javascript'>
    $(function() {
        function DashboardViewModel(viewModelObject) {
            var self = this;
            var model = ko.mapping.fromJS(viewModelObject);
            return model;
        }
        var model = new DashboardViewModel($.parseJSON("{{ dashboardViewModelJson|escapejs }}"));
        ko.applyBindings(model);
    });
    </script>
{%  endblock javascript %}
